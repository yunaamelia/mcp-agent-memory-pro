pre-commit:
  parallel: true
  jobs:
    # TypeScript/JavaScript
    - name: eslint
      glob: 'src/**/*.{ts,tsx}'
      run: npx eslint --fix --no-warn-ignored {staged_files}
      stage_fixed: true
      skip_empty: true

    - name: prettier-ts
      glob: '*.{ts,tsx,js,jsx,json}'
      run: npx prettier --write {staged_files}
      stage_fixed: true
      skip_empty: true

    # Python - fast checks only (ruff is very fast)
    - name: ruff-check
      glob: '*.py'
      run: ruff check --fix {staged_files}
      stage_fixed: true
      skip_empty: true

    - name: ruff-format
      glob: '*.py'
      run: ruff format {staged_files}
      stage_fixed: true
      skip_empty: true

    # Markdown - now installed locally
    - name: markdownlint
      glob: '*.md'
      run: npx markdownlint-cli --fix {staged_files}
      stage_fixed: true
      skip_empty: true

commit-msg:
  jobs:
    - name: commitlint
      run: npx commitlint --edit {1}

pre-push:
  parallel: true
  jobs:
    - name: typescript-check
      run: npx tsc --noEmit

    - name: python-tests
      run: python/venv/bin/python -m pytest tests/ -q --tb=short -x

    # mypy - disabled temporarily due to many type annotation issues
    # - name: mypy
    #   glob: '*.py'
    #   run: mypy python/ --ignore-missing-imports --no-error-summary
    #   skip_empty: true
